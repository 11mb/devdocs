<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Adding a custom indexer</title>
	<meta name="description" content="Magento 2 Developer Guide.
">

	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,700,600,300,800' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="/css/app.css" />
	<link rel="stylesheet" href="/css/print.css" media="print"/>
	<link rel="canonical" href="//guides/v2.1/extension-dev-guide/indexing-custom.html">

	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
        var baseUrl = "/";
    </script>

</head>
<body>

<header class="site-header">

	<nav role="navigation">

		<div class="menu-btn">
			<a class="menu-trigger menu-icon" href="#"></a>
		</div>

		<div id="global-nav">
			<div class="main-site-name">
				<a class="logo pull-left" href="/"> </a>
				<div class="sub-site-name">
					<a href="/">Developer Documentation (2.1)</a>
				</div>
			</div>
            
<div class="version-switcher dropdown">
	<button class="btn dropdown-toggle" data-toggle="dropdown">
		Version 2.1
	</button>


	<ul class="dropdown-menu dropdown-menu-left">
	
		<li><a class="dropdown-item" href="/guides/v2.0/extension-dev-guide/indexing-custom.html">Version 2.0</a></li>
	
		<li><a class="dropdown-item" href="/guides/v2.1/extension-dev-guide/indexing-custom.html">Version 2.1</a></li>
	
  </ul>

</div>


		</div><!-- #global-nav -->
	</nav>

	<div class="search-btn">
        <a class="search-trigger search-icon" href="/search.html"></a>
	</div>

</header>

<!--Sub Navigation-->
<div id="subnav-wrap" class="nav-main">
   <div id="subnav">
      <ul class="menu nav">
         <li class="first">
            <a href="#">Get Started</a>
            <ul class="menu nav">
               <li class="leaf"><a href="/guides/v2.1/architecture/bk-architecture.html">Magento Architecture</a></li>
               <li class="first leaf"><a href="/guides/v2.1/release-notes/bk-release-notes.html">Release Information</a></li>

            </ul>
         </li>
         <li class="first">
            <a href="#">System Administrator</a>
            <ul class="menu nav">
               <li class="first leaf"><a href="/guides/v2.1/install-gde/bk-install-guide.html">Installation Guide</a></li>
               
               <li class="leaf"><a href="/guides/v2.1/comp-mgr/bk-compman-upgrade-guide.html">Component Manager and System Upgrade Guide</a></li>
               
               <li class="leaf"><a href="/guides/v2.1/config-guide/bk-config-guide.html">Configuration Guide</a></li>
               <li class="leaf"><a href="/guides/v2.1/migration/bk-migration-guide.html">Migration Guide</a></li>
               <li class="leaf"><a href="/guides/v2.1/cloud/bk-cloud.html">Magento Enterprise Cloud Guide</a></li>
            </ul>
         </li>
         <li class="first">
            <a href="#">Developers</a>
            <ul class="menu nav">
               <li class="first leaf"><a href="/guides/v2.1/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li>
               
               <li class="first leaf"><a href="/guides/v2.1/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li>
               
			   
			   
               <li class="first leaf"><a href="/guides/v2.1/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li>
               <li class="first leaf"><a href="/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li>
               <li class="first leaf"><a href="/guides/v2.1/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices Guide</a></li>
               <li class="leaf"><a href="/guides/v2.1/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li>
               <li class="leaf"><a href="/guides/v2.1/rest/bk-rest.html">REST Reference</a></li>
               <li class="leaf"><a href="/guides/v2.1/soap/bk-soap.html">SOAP Reference</a></li>
               <li class="leaf"><a href="/guides/v2.1/coding-standards/bk-coding-standards.html">Coding Standards</a></li>
               <li class="leaf"><a href="/guides/v2.1/mrg/intro.html">Module Reference Guide</a></li>
               
                   <li class="leaf"><a href="/guides/v2.1/extension-dev-guide/staging.html">Staging</a></li>
               
            </ul>
         </li>
         <li class="first">
            <a href="#">Designers</a>
            <ul class="menu nav">
               <li class="first leaf"><a href="/guides/v2.1/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li>
               <li class="leaf"><a href="/guides/v2.1/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li>
            </ul>
         </li>
         <li class="first">
            <a href="#">Contributor</a>
            <ul class="menu nav">
               <li class="first leaf"><a href="/guides/v2.1/contributor-guide/contributing.html">Contributor Guide</a></li>
            </ul>
         </li>
          <li class="first">
              <a href="/guides/v2.1/test/testing.html">Testing</a>
              <ul class="menu nav">
                  <li class="leaf"><a href="/guides/v2.1/mtf/mtf_introduction.html">Functional Testing</a></li>
                  <li class="leaf"><a href="/guides/v2.1/test/integration/integration_test_execution.html">Integration Testing</a></li>
                  <li class="leaf"><a href="/guides/v2.1/extension-dev-guide/test/test_js-unit.html">JavaScript Unit Testing</a></li>
                  <li class="leaf"><a href="/guides/v2.1/test/unit/unit_test_execution.html">PHP Unit Testing</a></li>
                  <li class="leaf"><a href="/guides/v2.1/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li>
              </ul>
          </li>
         <li class="first">
            <a href="/guides/v2.1/howdoi/bk-how-do-i.html">How Do I...?</a>
         </li>
      </ul>

      <div class ="search">
         <div class="search-icon"></div>
         <form id="searchbox" name="gs" method="GET" action="/search.html">
            <input type="text" name="q" id="searchtext" value="" placeholder="Search" autofocus>
         </form>
      </div><!-- END searchbox-->

      <a href="#" class="nav-close">&times;</a>

   </div> <!--End subnav -->
</div><!--End subnav-wrap -->
<div class="nav-main-fader"></div>


<div id="gl-wrapper">

	<!-- /.main-container -->
	<div id="gl-container" class="main-container">
		<a id="main-content"></a>
		<div class="pane-content">
			<div class="node node-panel">


<!-- page-header -->
<section class="page-intro">
	<div class="container">
		<h1 class="page-heading">Adding a custom indexer</h1>

        

        <div class="topic-info">

            
               <div class="github-link"><a class="improve-page" href="https://github.com/magento/devdocs/tree/develop/guides/v2.0/extension-dev-guide/indexing-custom.md" target="_blank">Edit this page on GitHub</a></div>
            
            

        </div> 
		        
		
        <div class="float-break"></div>
	</div>
</section>


<div class="container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" class="toc-toggler">Table of Contents</a>
	<div class="sidebar-wrapper">


<h4>PHP Developer Guide</h4>






		<ul role="navigation">

		

		

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

					
					

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">Introduction</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/intro/developers_roadmap.html">Developer roadmap</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/intro/intro-composer.html">Introduction to Composer</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/intro/intro-composer-gloss.html">Glossary of common terms</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/prepare/prepare.html">Prepare (development quick start)</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/prepare/dev-modtypes.html">Component types and versioning</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/prepare/prepare_file-str.html">About component file structure</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/prepare/dev-summary.html">Roadmap for developing and packaging components</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/prepare/lifecycle.html">Extension lifecycle</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/build/build.html">Build</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/optimal-dev-environment.html">Optimal development environment</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/composer-integration.html">The composer.json file</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/required-configuration-files.html">Define your configuration files</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/module-file-structure.html">Create your component file structure</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/component-registration.html">Register your component</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/XSD-XML-validation.html">URN schema validation</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/create_component.html">Name your component</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/module-load-order.html">Component load order</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/build/enable-module.html">Enable or disable your component</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/package/package.html">Package</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/package/package_module.html">Package a component</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/package/package_mktpl.html">Upload your component to the Magento Marketplace</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/validate/validate.html">Validate</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/validate/test-module.html">Test your component</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/cli-cmds/cli-add.html">Add CLI commands</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/cli-cmds/cli-naming-guidelines.html">Command naming guidelines</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/cli-cmds/cli-howto.html">How to add CLI commands</a></li>

									

								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/staging.html">Staging (Enterprise Edition only)</a></li>
									
								

									


								




						

					

						

						

							


								


								
									<li class="level1 "><a class="nav-header" href="/guides/v2.1/extension-dev-guide/module-development.html">Component development</a></li>
									
								

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/service-contracts/service-contracts.html">Service contracts</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/api-concepts.html">Public interfaces & APIs</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/service-contracts/design-patterns.html">Service contract design patterns</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/depend-inj.html">Dependency injection</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/events-and-observers.html">Events and observers</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/factories.html">Instantiating objects with factories</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/proxies.html">Proxies</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/code-generation.html">Code generation</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/attributes.html">EAV and extension attributes</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/plugins.html">Plugins (Interceptors)</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/routing.html">Routing</a></li>

									

								

									

										<li class="level3Parent " id="index"><a href="#">Indexing</a>


									

								

									


											<li class="level3Child index " data-menunode="index"><a href="/guides/v2.1/extension-dev-guide/indexing.html">Indexing overview</a>


									

								

									


											<li class="level3Child index  active " data-menunode="index"><a href="/guides/v2.1/extension-dev-guide/indexing-custom.html">Adding a custom indexer</a>


									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/message-queues.html">Message Queues (Enterprise Edition Only)</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/service-contracts/service-to-web-service.html">Configure services as web APIs</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/backward-compatibility.html">Backward compatibility</a></li>

									

								

									

									<li class="level-2 "><a href="/guides/v2.1/howdoi/php/php_clear-dirs.html">Clear directories during development</a></li>

									

								




						

					

						

						

							


								


								

									

										<li class="levela1"><span class="nav-header">Security</span></li>

									


								

									

									<li class="level-2 "><a href="/guides/v2.1/extension-dev-guide/security/non-secure-functions.html">Non-secure functions</a></li>

									

								




						

					


				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

				

			

		</ul>

	</div>
</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
            <div class="updated">Updated: 28 September 2016 (PDT)</div>
            <h2 id="m2devgde-indexing-custom">Adding a custom indexer</h2>
<p>This topic discusses how to create a custom indexer. We’ve recently made a performance improvment that enables you to declare one or more <em>shared</em> indexers; if one of the shared indexes is already up-to-date, it doesn’t need to be reindexed.</p>

<p>To implement your own indexer, add the following code in your module:</p>

<ul>
  <li><a href="#m2devgde-indexing-customlogic">Indexer logic</a></li>
  <li><a href="#m2devgde-indexing-customconfiguration">Indexer configuration</a></li>
  <li><a href="#m2devgde-indexing-mview">MView configuration</a></li>
</ul>

<h3 id="m2devgde-indexing-customlogic">Custom indexer logic</h3>

<p>Your custom indexer class should implement <a href="https://github.com/magento/magento2/blob/2.0/lib/internal/Magento/Framework/Indexer/ActionInterface.php" target="_blank">\Magento\Framework\Indexer\ActionInterface</a>, and the indexer should be able to perform three types of operations:</p>

<ul>
  <li>Row reindex: processing a single entry from a dictionary; responsibility of <code>executeRow($id)</code></li>
  <li>List reindex: processing a set of dictionary entries; responsibility of <code>executeList($ids)</code>, where <code>$ids</code> is an array of entity IDs</li>
  <li>Rull reindex: processing all entities from a specific dictionary; responsibility of <code>executeFull()</code></li>
</ul>

<h3 id="m2devgde-indexing-customconfiguration">Indexer configuration</h3>
<p>In the <code>etc</code> directory of your module, add <code>indexer.xml</code> with the following:</p>

<ul>
  <li>indexer ID</li>
  <li>indexer class name</li>
  <li>indexer title</li>
  <li>indexer description</li>
  <li>indexer view ID</li>
  <li>shared indexes, if any</li>
</ul>

<p>Use the optional <code>shared_index=</code> parameter to improve performance if your indexer is related to another indexer. In this <a href="https://github.com/magento/magento2/blob/2.0/develop/app/code/Magento/CatalogRule/etc/indexer.xml" target="_blank">example</a>, if catalog rule product needs to be reindexed, but othe catalog product rule index is up-to-date, then only catalog rule product is reindexed.</p>

<p>All indexers related to a module should be declared in one file.</p>

<h3 id="m2devgde-indexing-mview">MView configuration</h3>
<p>Add the <code>mview.xml</code> configuration file in the <code>etc</code> module directory, where you declare the following:</p>

<ul>
  <li>indexer view ID</li>
  <li>indexer class</li>
  <li>the database tables the indexer tracks</li>
  <li>what column data is sent to the indexer</li>
</ul>

<p><a href="https://github.com/magento/magento2/blob/2.0/app/code/Magento/Catalog/etc/mview.xml" target="_blank">Example</a></p>

<p>All Mview declarations related to a module should be declared in one file.</p>

<h3 id="m2devgde-indexing-exampleimplementation">Example of a custom indexer implementation</h3>
<p>Suppose you want to push best-selling products to the top of a category listing. This requires processing statistics about sales to change the product position dynamically.</p>

<p>Assuming your module is named <code>&lt;VendorName&gt;_Merchandizing</code>, you must write the appropriate code in the indexer class:</p>

<script src="https://gist.github.com/xcomSteveJohnson/ef9be4963011bb13efe5.js"></script>

<p>Next, declare the indexer in <code>Merchandizing/etc/indexer.xml</code>:</p>

<script src="https://gist.github.com/xcomSteveJohnson/5780857cdd5343cafacf.js"></script>

<p>Finally, declare the indexer view (<code>merchandizing_popular_order</code>) that tracks sales (<code>Merchandizing/etc/mview.xml</code>):</p>

<script src="https://gist.github.com/xcomSteveJohnson/4313c5246b38ff8193df.js"></script>

<p>These settings start <code>&lt;VendorName&gt;\Merchandizing\Model\Indexer\Popular::execute</code> method every time an order is changed.</p>

<p>Now when an order is placed, the Popular Products indexer calculates the sorting order of the products by popularity and stores this data in the index table, so that it can be used in product displaying logic.</p>

		</div>
	</section>
<!-- /main content -->


</div> <!-- container -->


		</div>
		</div>
	</div>


</div>
<!-- -->
<!--Global footer-->
<div id="footer-wrap">
    <div id="copyright">
        <div class="container">
            <div class="copyright-date">&copy; 2016 Magento, Inc. All rights reserved.</div>
            <div class="copyright-links">
                <ul class="nav">
                    <li><a title="Privacy Policy" href="http://magento.com/legal/terms/privacy">Privacy Policy</a></li>
                    <li><a title="Terms of Service" href="http://magento.com/legal/terms">Terms of Service</a></li>
                    <li><a title="License/Trademark FAQ" href="http://magento.com/legal/licensing">License/Trademark FAQ</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="/common/js/jsCookie.js"></script>
<script src="/common/js/devdocs.js"></script>
<script src="/common/js/jquery-ui.min.js"></script>

<script type="text/javascript">
    (function() {
        var didInit = false;
        function initMunchkin() {
            if(didInit === false) {
                didInit = true;
                Munchkin.init('585-GGD-959', {cookieAnon: false});
            }
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = '//munchkin.marketo.net/munchkin.js';
        s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
                initMunchkin();
            }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>

<script src="/js/app.js"></script>

<!--Google Analytics-->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-66243208-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>

